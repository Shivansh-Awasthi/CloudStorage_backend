# ===========================================
# Storage Service - Environment Configuration
# ===========================================

# ----- Application -----
NODE_ENV=development
PORT=3000
API_PREFIX=/api

# ----- MongoDB -----
MONGODB_URI=mongodb://localhost:27017/storage-service
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=10
MONGODB_CONNECT_TIMEOUT_MS=10000
MONGODB_SOCKET_TIMEOUT_MS=45000

# ----- Redis -----
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=storage:

# ----- JWT Authentication -----
JWT_ACCESS_SECRET=your-super-secret-access-key-change-in-production
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# ----- Storage Configuration -----
# Base paths for tiered storage
STORAGE_BASE_PATH=./storage
STORAGE_SSD_PATH=./storage/ssd
STORAGE_HDD_PATH=./storage/hdd
STORAGE_TEMP_PATH=./storage/ssd/temp

# Storage provider: local | s3 (future) | gcs (future)
STORAGE_PROVIDER=local

# ----- Upload Configuration -----
# Chunk size in bytes (default: 10MB)
UPLOAD_CHUNK_SIZE=10485760
# Max file size for free users (10GB)
UPLOAD_MAX_FILE_SIZE_FREE=10737418240
# Max file size for premium users (unlimited = -1)
UPLOAD_MAX_FILE_SIZE_PREMIUM=-1
# Upload session TTL in seconds (24 hours)
UPLOAD_SESSION_TTL=86400

# ----- Rate Limiting -----
# Format: requests per window (window in seconds)
RATE_LIMIT_WINDOW_SECONDS=60

# Free user limits
RATE_LIMIT_FREE_UPLOAD=10
RATE_LIMIT_FREE_DOWNLOAD=50
RATE_LIMIT_FREE_AUTH=5

# Premium user limits
RATE_LIMIT_PREMIUM_UPLOAD=50
RATE_LIMIT_PREMIUM_DOWNLOAD=1000
RATE_LIMIT_PREMIUM_AUTH=10

# IP-based limits (for unauthenticated requests)
RATE_LIMIT_IP_UPLOAD=5
RATE_LIMIT_IP_DOWNLOAD=20
RATE_LIMIT_IP_AUTH=3

# ----- File Expiry (Free Users) -----
# Days until file expires if no downloads
FILE_EXPIRY_DAYS_FREE=5
# Days to extend on each download
FILE_EXPIRY_EXTENSION_DAYS=5

# ----- Storage Tier Migration -----
# Days of inactivity before SSD -> HDD migration
TIER_MIGRATION_HOT_TO_COLD_DAYS=7
# Downloads threshold to trigger HDD -> SSD migration
TIER_MIGRATION_COLD_TO_HOT_DOWNLOADS=5

# ----- Worker Configuration -----
# How often workers run (in seconds)
WORKER_EXPIRY_INTERVAL=3600
WORKER_MIGRATION_INTERVAL=3600
WORKER_CLEANUP_INTERVAL=3600
# Batch size for worker operations
WORKER_BATCH_SIZE=100

# ----- Security -----
# Allowed file MIME types (comma-separated, empty = all allowed)
ALLOWED_MIME_TYPES=
# Max filename length
MAX_FILENAME_LENGTH=255
# Enable/disable features
FEATURE_REGISTRATION_ENABLED=true
FEATURE_ANONYMOUS_DOWNLOAD=true

# ----- Logging -----
LOG_LEVEL=debug
LOG_FORMAT=json

# ----- CORS -----
CORS_ORIGIN=*
CORS_CREDENTIALS=true
